# Cart Page Feature - Issue Templates for Dependent Repos

This document contains issue templates to be created in the dependent repositories.

---

## Issue for octocat-supply-api

**Title:** `[octocat-supply-platform#1] Implement Cart Order Creation API`

**Assignees:** `@copilot`

**Labels:** `feature`, `backend`

**Body:**

```markdown
## Parent Issue
This task was spawned from copilot-skills-example/octocat-supply-platform#1

## Task Description

Implement API endpoint for creating orders from shopping cart data.

### Requirements

1. **New Endpoint: POST /api/orders**
   - Accept payload: `{ branchId: number, items: [{ productId: number, quantity: number }] }`
   - Validate all products exist
   - Create Order record (status: 'pending', orderDate: current timestamp)
   - Create OrderDetail records for each item (capture current product.price as unitPrice)
   - Use database transaction for atomicity
   - Return created order with nested details

2. **Validation**
   - Return 400 if branchId missing
   - Return 400 if items empty
   - Return 400 if any productId doesn't exist
   - Return appropriate error messages

3. **Swagger Documentation**
   - Document request schema
   - Document response schema
   - Add error response examples

4. **Testing**
   - Integration test for successful order creation
   - Test validation error cases
   - Verify transaction rollback on error

### API Contract

**Request:**
```json
POST /api/orders
Content-Type: application/json

{
  "branchId": 1,
  "items": [
    { "productId": 5, "quantity": 2 },
    { "productId": 12, "quantity": 1 }
  ]
}
```

**Success Response (201):**
```json
{
  "orderId": 42,
  "branchId": 1,
  "orderDate": "2026-02-06T18:30:00.000Z",
  "status": "pending",
  "details": [
    {
      "orderDetailId": 100,
      "productId": 5,
      "quantity": 2,
      "unitPrice": 29.99,
      "product": {
        "productId": 5,
        "name": "Widget A",
        "sku": "WDG-001"
      }
    }
  ]
}
```

**Error Response (400):**
```json
{
  "error": "Product not found",
  "productId": 999
}
```

## OctoCAT Entity Model

### Order
- `orderId` (number, PK)
- `branchId` (number, FK → Branch)
- `orderDate` (string, ISO 8601)
- `status` (string: pending/processing/shipped/delivered/cancelled)
- `name` (string, optional)
- `description` (string, optional)

### OrderDetail
- `orderDetailId` (number, PK)
- `orderId` (number, FK → Order)
- `productId` (number, FK → Product)
- `quantity` (number, required)
- `unitPrice` (number, required - snapshot of product price at order time)
- `notes` (string, optional)

### Product
- `productId` (number, PK)
- `name` (string)
- `price` (number)
- `sku` (string)
- Other fields...

## Architecture Context

- Stack: Express.js / SQLite / Repository pattern / Swagger-OpenAPI
- Use existing repository pattern (e.g., `OrdersRepository`, `ProductsRepository`)
- Wrap multi-table inserts in transaction
- Follow existing error handling patterns
- Update Swagger spec file

## Integration Notes

- **Provides:** POST /api/orders endpoint for frontend to consume
- **Depends on:** Existing Product, Order, OrderDetail entities in database

## Acceptance Criteria

- [ ] POST /api/orders endpoint implemented
- [ ] Order + OrderDetail records created in transaction
- [ ] Product validation returns appropriate errors
- [ ] Swagger documentation updated
- [ ] Integration tests added and passing
- [ ] Returns enriched order object with details

## Reference

See `copilot-skills-example/octocat-supply-platform` repo:
- `/specs/features/cart-page.md` - Full specification
- `/architecture/entity-model.md` - Entity field definitions

---
*Auto-generated by Copilot multi-repo orchestration*
```

---

## Issue for octocat-supply-web

**Title:** `[octocat-supply-platform#1] Implement Cart Page and Shopping Flow`

**Assignees:** `@copilot`

**Labels:** `feature`, `frontend`

**Body:**

```markdown
## Parent Issue
This task was spawned from copilot-skills-example/octocat-supply-platform#1

## Task Description

Implement shopping cart functionality with cart page, context provider, and product page integration.

### Requirements

#### 1. Cart Context Provider (`src/contexts/CartContext.tsx`)
- Manage cart state: `cartItems: { productId, name, price, quantity, imgName }[]`
- Actions:
  - `addToCart(product, quantity)` - Add or increment item
  - `removeFromCart(productId)` - Remove item
  - `updateQuantity(productId, quantity)` - Update quantity
  - `clearCart()` - Empty cart
- Compute derived values: `totalItems`, `subtotal`
- Persist to localStorage/sessionStorage

#### 2. Navigation Component Updates
- Add cart icon with badge showing item count
- Link to `/cart` route
- Badge hidden when cart empty

#### 3. Cart Page (`src/pages/CartPage.tsx`)
- **Empty state:** Message + "Browse Products" CTA
- **Cart items list:**
  - Product image, name, price
  - Quantity controls (increment/decrement)
  - Line total (price × quantity)
  - Remove button
- **Cart summary:**
  - Subtotal
  - Item count
  - "Continue Shopping" link
  - "Place Order" button
- **Place Order flow:**
  - Show loading state
  - Call `POST /api/orders` via React Query
  - On success: toast, clear cart, redirect
  - On error: show error toast

#### 4. Products Page Integration
- Add "Add to Cart" button to product cards
- Show success toast on add
- Display current quantity if item in cart

#### 5. Routing
- Add `/cart` route in React Router

#### 6. Styling
- Use Tailwind CSS
- Support dark mode via ThemeContext
- Responsive design (mobile-first)
- Follow design mockup: `copilot-skills-example/octocat-supply-platform/docs/design/cart.png`

#### 7. Toast Notifications
- Success: "Added to cart"
- Success: "Order placed successfully"
- Error: API error messages

## OctoCAT Entity Model

### Order (API response)
- `orderId`, `branchId`, `orderDate`, `status`
- `details[]`: array of OrderDetail objects

### Product
- `productId`, `name`, `price`, `sku`, `imgName`

### Cart Item (Frontend state)
```typescript
interface CartItem {
  productId: number;
  name: string;
  price: number;
  quantity: number;
  imgName?: string;
}
```

## Architecture Context

- Stack: React 18+ / Vite / Tailwind CSS / React Router v7 / React Query
- Use React Context API for cart state
- Use React Query for POST /api/orders mutation
- Follow existing component patterns and Tailwind utility classes
- Support ThemeContext for dark mode

## Integration Notes

- **Depends on:** `POST /api/orders` endpoint from octocat-supply-api
- **Provides:** Complete cart shopping experience for users
- **Branch ID:** Use hardcoded branchId (e.g., 1) or from app context if available

## TypeScript Types

```typescript
interface CartItem {
  productId: number;
  name: string;
  price: number;
  quantity: number;
  imgName?: string;
}

interface CartContextValue {
  items: CartItem[];
  totalItems: number;
  subtotal: number;
  addToCart: (product: Product, quantity: number) => void;
  removeFromCart: (productId: number) => void;
  updateQuantity: (productId: number, quantity: number) => void;
  clearCart: () => void;
}

interface CreateOrderPayload {
  branchId: number;
  items: { productId: number; quantity: number }[];
}
```

## Acceptance Criteria

- [ ] CartContext provider implemented with full API
- [ ] Cart page displays items with quantity controls
- [ ] Navigation shows cart icon with badge
- [ ] Products page has "Add to Cart" buttons
- [ ] "Place Order" calls API and handles success/error
- [ ] Cart clears after successful order
- [ ] Cart persists across navigation
- [ ] Toast notifications work
- [ ] Responsive design with dark mode support
- [ ] Follows design mockup

## Reference

See `copilot-skills-example/octocat-supply-platform` repo:
- `/specs/features/cart-page.md` - Full specification
- `/docs/design/cart.png` - UI mockup
- `/architecture/entity-model.md` - Entity definitions

---
*Auto-generated by Copilot multi-repo orchestration*
```

---

## Instructions

To spawn these issues:

1. Navigate to `copilot-skills-example/octocat-supply-api` repository
2. Create new issue with API template content above
3. Assign to `@copilot`
4. Add labels: `feature`, `backend`

5. Navigate to `copilot-skills-example/octocat-supply-web` repository
6. Create new issue with Frontend template content above
7. Assign to `@copilot`
8. Add labels: `feature`, `frontend`

Once created, update the master issue (copilot-skills-example/octocat-supply-platform#1) with links to the spawned issues.
